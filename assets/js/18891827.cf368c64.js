"use strict";(self.webpackChunk_agoralabs_sh_avm_web_provider=self.webpackChunk_agoralabs_sh_avm_web_provider||[]).push([[1235],{4050:function(e,n,t){t.r(n),t.d(n,{assets:function(){return l},contentTitle:function(){return a},default:function(){return p},frontMatter:function(){return s},metadata:function(){return d},toc:function(){return c}});var r=t(4848),i=t(8453),o=t(4252);const s={slug:"/"},a="Overview",d={id:"overview",title:"Overview",description:"<TOCInline",source:"@site/docs/overview.mdx",sourceDirName:".",slug:"/",permalink:"/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{slug:"/"},sidebar:"docs",next:{title:"Terminology",permalink:"/terminology"}},l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"How it works",id:"how-it-works",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"overview",children:"Overview"})}),"\n","\n",(0,r.jsx)(o.A,{maxHeadingLevel:4,toc:c}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"The AVM Web Provider is an interface that bridges the gap between clients (e.g. dApps) and providers (e.g. wallets), allowing clients to connect and interact with providers in a standardized way."}),"\n",(0,r.jsx)(n.p,{children:"The AVM Web Provider works towards achieving two main goals:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Creating a common interface between clients and providers."}),"\n",(0,r.jsx)(n.li,{children:"Allowing clients to choose what provider to use."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,r.jsx)(n.p,{children:'Traditionally, web-based provider inject script into a web page\'s document and "hijack" a property on the global object. This can be problematic as browser extensions are loaded in the web page in an unpredictable and unstable order, so for a user that uses multiple providers this will cause the last provider loaded to re-initialize the global property that was already initialized by another provider.'}),"\n",(0,r.jsx)(n.p,{children:"In order to prevent provider collisions, the client emits an event and instantiates an event listener. The provider listens to the client's incoming events and upon receiving an event, emits an event in response. This forms an event concurrency loop."}),"\n",(0,r.jsx)(n.p,{children:"Since the client code and provider code aren\u2019t guaranteed to run in a particular order, the events are designed to handle such race conditions."}),"\n",(0,r.jsxs)(n.p,{children:["Both clients and providers use the ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent",children:(0,r.jsx)(n.code,{children:"window.dispatchEvent"})})," function to emit events, and use the ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener",children:(0,r.jsx)(n.code,{children:"window.addEventListener"})})," function to observe events."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Browser extension providers ",(0,r.jsx)(n.strong,{children:"MUST"})," take advantage of the ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content_scripts",children:"content scripts"})," that will allow the provider access to the ",(0,r.jsx)(n.code,{children:"window"})," object."]})}),"\n",(0,r.jsxs)(n.p,{children:["The AVM Web Provider leverages the ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/EventTarget",children:(0,r.jsx)(n.code,{children:"EventTarget"})})," API as a transport layer to deliver messages and allows clients and web-based providers to securely communicate without interfering with other providers."]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);