"use strict";(self.webpackChunk_agoralabs_sh_avm_web_provider=self.webpackChunk_agoralabs_sh_avm_web_provider||[]).push([[5160],{1159:function(e,s,n){n.r(s),n.d(s,{assets:function(){return c},contentTitle:function(){return p},default:function(){return v},frontMatter:function(){return d},metadata:function(){return l},toc:function(){return h}});var i=n(4848),r=n(8453),t=n(1470),o=n(9365),a=n(4252);const d={},p="Responding To Disable Requests",l={id:"usage/providers/responding-to-disable-requests",title:"Responding To Disable Requests",description:"<TOCInline",source:"@site/docs/usage/providers/responding-to-disable-requests.mdx",sourceDirName:"usage/providers",slug:"/usage/providers/responding-to-disable-requests",permalink:"/usage/providers/responding-to-disable-requests",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{}},c={},h=[{value:"Overview",id:"overview",level:2},{value:"Responding to a disable request",id:"responding-to-a-disable-request",level:2},{value:"Responding to a disable request with a specific network",id:"responding-to-a-disable-request-with-a-specific-network",level:2},{value:"Responding to specific session IDs",id:"responding-to-specific-session-ids",level:2}];function u(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"responding-to-disable-requests",children:"Responding To Disable Requests"})}),"\n",(0,i.jsx)(a.A,{maxHeadingLevel:4,toc:h}),"\n",(0,i.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(s.p,{children:"Providers that implement a session for a client, a disable request can be called by a client that instructs the provider to remove the client's session."}),"\n",(0,i.jsx)(s.h2,{id:"responding-to-a-disable-request",children:"Responding to a disable request"}),"\n",(0,i.jsx)(s.p,{children:"Once our provider object has been initialized, we can simply listen to events and respond:"}),"\n",(0,i.jsxs)(t.A,{defaultValue:"javascript",values:[{label:"Javascript",value:"javascript"},{label:"TypeScript",value:"typescript"}],children:[(0,i.jsx)(o.A,{value:"javascript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-js",children:"// initialized provider\nprovider.onDisable(() => {\n  // ... remove all sessions\n\n  return {\n    genesisHash: 'SGO1GKSzyE7IEPItTxCByw9x8FmnrCDexi9/cOUJOiI=',\n    genesisId: 'testnet-v1.0',\n    providerId: '02657eaf-be17-4efc-b0a4-19d654b2448e',\n  };\n});\n"})})}),(0,i.jsx)(o.A,{value:"typescript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"// initialized provider\nprovider.onDisable(() => {\n  // ... remove all sessions\n\n  return {\n    genesisHash: 'SGO1GKSzyE7IEPItTxCByw9x8FmnrCDexi9/cOUJOiI=',\n    genesisId: 'testnet-v1.0',\n    providerId: '02657eaf-be17-4efc-b0a4-19d654b2448e',\n  };\n});\n"})})})]}),"\n",(0,i.jsx)(s.admonition,{type:"note",children:(0,i.jsx)(s.p,{children:"If no network or session IDs have been specified, you can assume all sessions for this client should be removed."})}),"\n",(0,i.jsx)(s.admonition,{type:"caution",children:(0,i.jsxs)(s.p,{children:["If this method is not supported, then a ",(0,i.jsx)(s.a,{href:"../../api-reference/errors#methodnotsupportederror",children:(0,i.jsx)(s.code,{children:"MethodNotSupportedError"})})," should be thrown."]})}),"\n",(0,i.jsx)(s.h2,{id:"responding-to-a-disable-request-with-a-specific-network",children:"Responding to a disable request with a specific network"}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"disable"})," request allows the client to specify the network. This is denoted in the supplied ",(0,i.jsx)(s.code,{children:"params.genesisHash"})," parameter."]}),"\n",(0,i.jsxs)(t.A,{defaultValue:"javascript",values:[{label:"Javascript",value:"javascript"},{label:"TypeScript",value:"typescript"}],children:[(0,i.jsx)(o.A,{value:"javascript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-js",children:"const { ARC0027NetworkNotSupportedError } = require('@agoralabs-sh/avm-web-provider');\n\nconst genesisHash = 'SGO1GKSzyE7IEPItTxCByw9x8FmnrCDexi9/cOUJOiI=';\nconst providerId = '02657eaf-be17-4efc-b0a4-19d654b2448e';\n\n// initialized provider\nprovider.onDisable(({ params }) => {\n  // if the genesis hash has been defined, it is recommended that you throw and error\n  if (param.genesisHash && param.genesisHash !== genesisHash) {\n    throw new ARC0027NetworkNotSupportedError({\n      genesisHashes: [param.genesisHash],\n      providerId,\n    });\n  }\n\n  // ... remove all sessions for the network\n\n  return {\n    genesisHash,\n    genesisId: 'testnet-v1.0',\n    providerId,\n  };\n});\n"})})}),(0,i.jsx)(o.A,{value:"typescript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"import type { ARC0027NetworkNotSupportedError, IAVMWebProviderCallbackOptions } from '@agoralabs-sh/avm-web-provider';\n\nconst genesisHash = 'SGO1GKSzyE7IEPItTxCByw9x8FmnrCDexi9/cOUJOiI=';\nconst providerId = '02657eaf-be17-4efc-b0a4-19d654b2448e';\n\n// initialized provider\nprovider.onDisable(({ params }: IAVMWebProviderCallbackOptions) => {\n  // if the genesis hash has been defined, it is recommended that you throw and error\n  if (param.genesisHash && param.genesisHash !== genesisHash) {\n    throw new ARC0027NetworkNotSupportedError({\n      genesisHashes: [param.genesisHash],\n      providerId,\n    });\n  }\n\n  // ... remove all sessions for the network\n\n  return {\n    genesisHash,\n    genesisId: 'testnet-v1.0',\n    providerId,\n  };\n});\n"})})})]}),"\n",(0,i.jsx)(s.admonition,{type:"caution",children:(0,i.jsxs)(s.p,{children:["If the network is specified, and the provider does not support the network, then a ",(0,i.jsx)(s.a,{href:"../../api-reference/errors#networknotsupportederror",children:(0,i.jsx)(s.code,{children:"NetworkNotSupportedError"})})," should be thrown."]})}),"\n",(0,i.jsx)(s.h2,{id:"responding-to-specific-session-ids",children:"Responding to specific session IDs"}),"\n",(0,i.jsx)(s.p,{children:"A requesting client can specify the particular session. This can be used instead of specifying the network, or if the provider supports multiple sessions."}),"\n",(0,i.jsxs)(t.A,{defaultValue:"javascript",values:[{label:"Javascript",value:"javascript"},{label:"TypeScript",value:"typescript"}],children:[(0,i.jsx)(o.A,{value:"javascript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-js",children:"const providerId = '02657eaf-be17-4efc-b0a4-19d654b2448e';\nconst sessionId = '2802dff6-930e-4f79-8f67-ba9d41e88cf8';\n\n// initialized provider\nprovider.onDisable(({ params }) => {\n  if (params && params.sessionIds.indexOf(sessionId) >= 0) {\n    // ... remove sessions specified in the session ids list\n\n    return {\n      genesisHash: 'SGO1GKSzyE7IEPItTxCByw9x8FmnrCDexi9/cOUJOiI=',\n      genesisId: 'testnet-v1.0',\n      providerId,\n      sessionIds: [sessionId],\n    };\n  }\n});\n"})})}),(0,i.jsx)(o.A,{value:"typescript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"import type { IAVMWebProviderCallbackOptions } from '@agoralabs-sh/avm-web-provider';\n\nconst providerId = '02657eaf-be17-4efc-b0a4-19d654b2448e';\nconst sessionId = '2802dff6-930e-4f79-8f67-ba9d41e88cf8';\n\n// initialized provider\nprovider.onDisable(({ params }: IAVMWebProviderCallbackOptions) => {\n  if (params && params.sessionIds.includes(sessionId)) {\n    // ... remove sessions specified in the session ids list\n\n    return {\n      genesisHash: 'SGO1GKSzyE7IEPItTxCByw9x8FmnrCDexi9/cOUJOiI=',\n      genesisId: 'testnet-v1.0',\n      providerId,\n      sessionIds: [sessionId],\n    };\n  }\n});\n"})})})]}),"\n",(0,i.jsx)(s.admonition,{type:"note",children:(0,i.jsx)(s.p,{children:"It is recommended that when removing specific session IDs, only return the removed session IDs in the result."})})]})}function v(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);